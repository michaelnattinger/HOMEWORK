% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[11pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....

\usepackage{graphicx} % support the \includegraphics command and options

\usepackage{amssymb}
\usepackage{amsmath}
%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
% These packages are all incorporated in the memoir class to one degree or another...

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!
\usepackage{graphicx}
\graphicspath{ {./pings/} }

\usepackage{amsmath}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcount\colveccount
\newcommand*\colvec[1]{
        \global\colveccount#1
        \begin{pmatrix}
        \colvecnext
}
\def\colvecnext#1{
        #1
        \global\advance\colveccount-1
        \ifnum\colveccount>0
                \\
                \expandafter\colvecnext
        \else
                \end{pmatrix}
        \fi
}

%%% END Article customizations

%%% The "real" document content comes below...

\title{Macro PS1}
\author{Michael B. Nattinger\footnote{I worked on this assignment with my study group: Alex von Hafften, Andrew Smith, and Ryan Mather. I have also discussed problem(s) with Emily Case, Sarah Bass, and Danny Edgel.}}

%\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 

\begin{document}
\maketitle
\section{Question 1}
\subsection{Part A}
\begin{align*}
V(A_t,c_{t-1}) = &\max_{c_t,A_{t+1}} u(c_t,c_{t-1}) + \beta V(A_{t+1},c_t)\\
&\text{s.t. } A_{t+1} = R(A_t - c_t)
\end{align*}

We can rewrite this as the following:

\begin{align}
V(A_t,c_{t-1}) = &\max_{c_t} u(c_t,c_{t-1}) + \beta V(R(A_t - c_t),c_t) \label{eqn:V1}%\\
%V(A_t,c_{t-1}) = &\max_{A_t} u\left(A_t - \frac{A_{t+1}}{R},c_{t-1}\right) + \beta V\left(A_{t+1},A_t - \frac{A_{t+1}}{R}\right) \label{eqn:V2}
\end{align}

To ensure the solution is unique, with a strictly increasing, strictly concave value function that is differentiable on the interior of the feasible set, we require the following assumptions:
\begin{itemize}
\item $u(.)$ is continuously differentiable, strictly concave, and strictly increasing in its arguments.
\item $0<\beta <1$
\item $\lim_{k\rightarrow 0} u'(k,u) = \lim_{k\rightarrow 0} u'(u,k) = \infty$
\item $\lim_{k\rightarrow \infty} u'(k,u) = \lim_{k\rightarrow \infty} u'(u,k) = 0$
\item The utility function is bounded?
\item Do we need anything else?
\end{itemize}

Assuming the above conditions hold, we can solve the value function as it is written in (\ref{eqn:V1}) by taking a first order condition with respect to $c_t,$ and then applying the envelope theorem twice:
%\begin{align*}
%0 &=\frac{\partial u}{\partial c_t}(c_t,c_{t-1}) - R\beta \frac{\partial V}{\partial R(A_t - c_t)}(R(A_t - c_t),c_t) + \beta \frac{\partial V}{\partial c_t}(R(A_t - c_t),c_t)\\
%\frac{\partial V}{\partial R(A_t - c_t)}(R(A_t - c_t),c_t) &= 999\\
%\frac{\partial V}{\partial c_t}(R(A_t - c_t),c_t) &= \frac{\partial u}{\partial c_t}(c_{t+1},c_{t}) \\
%\Rightarrow \frac{\partial u}{\partial c_t}(c_t,c_{t-1}) + \beta () &= R\beta ()
%\end{align*}

\begin{align}
0&= u_1(c',c) + \beta (-RV_1(RA-Rc',c') + V_2(RA-Rc',c')) \label{eqn:FOC} \\
V_1(A,c) &= R\beta V_1(RA-Rc',c') \label{eqn:env1} \\
V_2(A,c) &= u_2(c',c) \label{eqn:env2}
\end{align}
Next, we can substitute in the envelope conditions (\ref{eqn:env1}), (\ref{eqn:env2}) into our first order condition (\ref{eqn:FOC}) to find an expression for $V_1,$ and substitute back into our initial first order condition (\ref{eqn:FOC}):
\begin{align*}
\Rightarrow 0 &= u_1(c',c) + \beta \left( -\frac{V_1(A,c)}{\beta} + u_2(c'',c')\right)
\end{align*}
\begin{align}
\Rightarrow V_1(A,c) &= u_1(c',c) + \beta(c'',c') \label{eqn:redux}
\end{align}
We can now combine equations (\ref{eqn:FOC}), (\ref{eqn:env2}), (\ref{eqn:redux}) to yield the following:
\begin{align*}
 0&= u_1(c',c) + \beta(-R(u_1(c'',c') + \beta u_2(c''',c'')) + u_2(c'',c'))
\end{align*}
\begin{align}
\Rightarrow 0&= u_1(c',c) - \beta R u_1(c'',c') - \beta^2 R u_2(c''',c'') + \beta u_2(c'',c') \label{eqn:optcon}
\end{align}

Equation (\ref{eqn:optcon}) yields our optimality condition.

\subsection{Part B}
With the utility function as given, our value function becomes the following:
\begin{align*}
V(A,c) &= \max_{c'} log(c') + \gamma log(c) + \beta V(RA-Rc',c')
\end{align*}
The optimal choice $c'$ takes the form of the $\argmax$ of the optimization problem. 
\begin{align*}
c' &= \argmax_{c'}  log(c') + \gamma log(c) + \beta V(RA-Rc',c')\\
&=  \argmax_{c'}  log(c') + \gamma log(c) + \beta \max_{c''} log(c'') + \gamma log(c') + \beta V(RA-Rc'',c'') \\ %V(RA-Rc',c')
&=  \argmax_{c'}  log(c') + \gamma log(c') + \gamma log(c) + \beta \max_{c''} log(c'')  + \beta V(RA-Rc'',c'') \\
&=  \argmax_{c'}  log(c') + \gamma log(c') + \beta \max_{c''} log(c'')  + \beta V(RA-Rc'',c'') 
\end{align*}
 This $\argmax$ is independent of c. 

We can rewrite this Bellman equation as the following, which will preserve the choice of $c'$:
\begin{align*}
V(A) &= \max_{A'} (1+\gamma)log\left(\frac{A'}{R} - A \right)  + \beta V(A')
\end{align*}
Taking FOC's,
\begin{align*}
0 &= \frac{1+\gamma}{R\left(\frac{A'}{R} - A \right)} +\beta V'(A')\\
V'(A) &= -\frac{1+\gamma}{\left(\frac{A'}{R} - A \right)} \\
\Rightarrow  \frac{1+\gamma}{R\left(\frac{A'}{R} - A \right)} &=\beta \frac{1+\gamma}{\left(\frac{A''}{R} - A' \right)}\\
\Rightarrow \left(\frac{A''}{R} - A' \right) &= \beta R\left(\frac{A'}{R} - A \right)\\
\Rightarrow A'' &= A'(1+\beta)R - \beta R^2 A
\end{align*}

Now we will solve for our optimality conditions. Applying (\ref{eqn:optcon}) to our new utility function yields the following:
\begin{align*}
\beta R (c'')^{-1} + \gamma \beta^2 R (c'')^{-1}&=(c')^{-1} + \gamma \beta (c')^{-1}\\
\Rightarrow c' \beta R (1+\gamma \beta) &= c''(1+\gamma \beta)
\end{align*}
\begin{align}
\Rightarrow c'\beta R &= c'' \label{eqn:euler}
\end{align}
Equation (\ref{eqn:euler}) yields our Euler conditions. 

Given a set of assets in an initial period, $A_1$, $c_{t+1}  = \beta R c_t$ $\forall t \in \mathbb{N}$. 
%With the utility function as given, our value function becomes the following:
%\begin{align*}
%V(A,c) &= \max_{c'} log(c') + \gamma log(c) + \beta V(RA-Rc',c')
%\end{align*}
%The optimal choice $c'$ takes the form of the $\argmax$ of the optimization problem. 
%\begin{align*}
%c' &= \argmax_{c'}  log(c') + \gamma log(c) + \beta V(RA-Rc',c')\\
%&=  \argmax_{c'}  log(c') + \gamma log(c) + \beta \max_{c''} log(c'') + \gamma log(c') + \beta V(RA-Rc'',c'') \\ %V(RA-Rc',c')
%&=  \argmax_{c'}  log(c') + \gamma log(c') + \gamma log(c) + \beta \max_{c''} log(c'')  + \beta V(RA-Rc'',c'') \\
%&=  \argmax_{c'}  log(c') + \gamma log(c') + \beta \max_{c''} log(c'')  + \beta V(RA-Rc'',c'') 
%\end{align*}
% This $\argmax$ is independent of c
%\begin{align*}
%
%\end{align*}
%I think that doesn't work - taking another crack at it here

%Instead we will use the value function as it is written in (\ref{eqn:V2}) by taking a first order condition with respect to $A_{t+1},$ and then applying the envelope theorem twice:
%\begin{align*}
%0 &=\frac{-1}{R}\frac{\partial u}{\partial A_t - \frac{A_{t+1}}{R}}\left(A_t - \frac{A_{t+1}}{R},c_{t-1}\right) + \beta \frac{\partial V}{\partial A_{t+1}}\left(A_{t+1},A_t - \frac{A_{t+1}}{R}\right) - \frac{\beta}{R} \frac{\partial V}{\partial A_t - \frac{A_{t+1}}{R}}\left(A_{t+1},A_t - \frac{A_{t+1}}{R}\right)\\
%&\frac{\partial V}{\partial R(A_t - c_t)}(R(A_t - c_t),c_t) = 999\\
%&\frac{\partial V}{\partial c_t}(R(A_t - c_t),c_t) = \frac{\partial u}{\partial c_t}(c_{t+1},c_{t}) \\
%&\Rightarrow \frac{\partial u}{\partial c_t}(c_t,c_{t-1}) + \beta () = R\beta ()
%\end{align*}

\subsection{Part C}

No, in general this will not hold. The utility function given to us was a seperable utility function, and for a non-separable utility function the utility 

\section{Question 2}
\subsection{Part A}
The sequence problem is to maximize profits:
\begin{align*}
\max_{\{ x_t\}_{i=1}^{\infty}} \left( \frac{1}{1+r} \right)^{t}\left( ax_t - \frac{b}{2}x_t^2 - \frac{c}{2}(x_{t+1}-x_t)^2\right)
\end{align*}

We can rewrite this as a bellman equation in the following way:

\begin{align}
V(x) =\max_{y} ax - \frac{b}{2}x^2 - \frac{c}{2}(y-x)^2 + \delta V(y) \label{eqn:bell}
\end{align}

We can rewrite this as follows:

\begin{align}
T(v)(x) =\max_{y} ax - \frac{b}{2}x^2 - \frac{c}{2}(y-x)^2 + \delta v(y) \label{eqn:bellT}
\end{align}

where the fixed point of our $T$ operator in (\ref{eqn:bellT}) is the solution to the Bellman equation in (\ref{eqn:bell}).

\subsection{Part B}

Let $L<0$ be arbitrary. If we set $y=0,x<\frac{L}{a}$ then $F(x,y) = ax -\frac{b}{2}x^2 - \frac{c}{2}(y-x)^2 \leq ax<L$ so $F$ is unbounded below.

This $F$ function is of the form of a polynomial with limits of negative infinity in all directions, so we can find the global maximum by taking first order conditions:
 \begin{align*}
0 &= a - bx + c(y-x)\\
0 &= -c(y-x) \Rightarrow y-x = 0 \Rightarrow y=x\\
\Rightarrow y = x &= \frac{a}{b}\\
F\left( \frac{a}{b},\frac{a}{b} \right) &= a\left(\frac{a}{b}\right) - \frac{b}{2}\left( \frac{a}{b}\right)^2 - 0\\
&= \frac{a^2}{2b}
\end{align*}

Therefore, the maximum value $F$ can take is $\frac{a^2}{2b}$

We can find bounds on $\hat{v}$ in the following way:

\begin{align*}
\hat{v} &= \frac{a^2}{2b} + \delta \hat{v}\\
\Rightarrow \hat{v} &= \frac{a^2}{2b(1-\delta)} 
\end{align*}

\subsection{Part C}
\begin{align*}
T\hat{v}(x) &= \max_{y} ax - \frac{b}{2}x^2 - \frac{c}{2}(y-x)^2 + \delta \hat{v}\\
0 &= -c(y-x) \Rightarrow y=x,\\
\Rightarrow T\hat{v}(x) &= ax -\frac{b}{2}x^2 +\delta \hat{v} \\
&\leq \frac{a^2}{2b} +\delta \frac{a^2}{2b(1-\delta)} = \frac{a^2}{2b(1-\delta)}\\
&= \hat{v}.
\end{align*}

\subsection{Part D}
We showed the base case of the induction in Part C. Now we will show the induction step.

Assume that $T^n\hat{v}(x)$ takes the form $T^n\hat{v}(x) = \alpha_n x - \frac{1}{2}\beta_n x^2 + \gamma_n.$ Then,
\begin{align*}
T^{n+1}\hat{v} (x) &= \max_y ax - \frac{b}{2}x^2 - \frac{c}{2}(y-x)^2 + \delta (\alpha_n x - \frac{1}{2}\beta_n x^2 + \gamma_n)\\
y=x \Rightarrow T^{n+1}\hat{v} (x) &= ax - \frac{b}{2}x^2 + \delta \alpha_n x - \delta \frac{1}{2}\beta_n x^2 + \delta \gamma_n\\
&= (a+\delta \alpha_n) x - \frac{b + \delta \beta_n}{2}x^2 +\delta \gamma_n\\
&= \alpha_{n+1} x - \frac{1}{2}\beta_{n+1} x^2 + \gamma_{n+1}
\end{align*}

where $\alpha_{n+1} =  (a+\delta \alpha_n) , \beta_{n+1} = b + \delta \beta_n ,  \gamma_{n+1} = \delta \gamma_n $.

\subsection{Part E}
Note that $\alpha_{n} = a + \delta a + \delta^2 a + \dots$, $\beta_n = b + \delta b + \delta^2 b + \dots, \gamma_n = \delta^n\hat{v}$. Thus, we can take the limit of $\alpha,\beta$ as geometric sums, and the limit of $\gamma_n$ is $0$. Therefore,

\begin{align*}
\tilde{V} &= \lim_{n\rightarrow \infty} T^n \hat{v} = \frac{a}{1-\delta}x - \frac{1}{2}\frac{b}{1-\delta}x^2.\\
T\tilde{V} &= \max_{y} ax - \frac{b}{2}x^2 - \frac{c}{2}(y-x)^2 + \delta \frac{a}{1-\delta}x - \frac{1}{2}\frac{b}{1-\delta}x^2,\\
y=x\Rightarrow T\tilde{V} &=  ax - \frac{b}{2}x^2 + \delta \frac{a}{1-\delta}x - \frac{1}{2}\frac{b}{1-\delta}x^2\\
&= \frac{a}{1-\delta}x - \frac{1}{2}\frac{b}{1-\delta}x^2\\
&= \tilde{T}.
\end{align*}
Therefore, the limit function $\tilde{V}$ satisfies the Bellman equation.
\section{Question 3}
\subsection{Part A}
\begin{align*}
V(k) &= \max_{k'} \pi (k) - \gamma(k' - (1-\delta)k) + \frac{1}{R}V(k')
\end{align*}

\begin{align*}
0&= -\gamma' (k' - (1-\delta)k) + \frac{1}{R}\left( \pi'(k') + (1-\delta) \gamma'(k'' - (1-\delta)k') \right)\\
\Rightarrow \pi '(k') + (1-\delta) \gamma ' (k'' - (1-\delta)k')&= R \gamma'(k' - (1-\delta)k)
\end{align*}

\subsection{Part B}
Letting $k = k' = k'' = \bar{k},$ we know that $\bar{I} = \delta \bar{k}$ and, moreover, we can rewrite our conditions for optimization in the following way:

\begin{align*}
\pi '(\bar{k}) + (1-\delta) \gamma '(\bar{I}) &= R \gamma'(\bar{I}))\\
\Rightarrow \pi'(\bar{k}) &= (R-1 + \delta)\gamma'(\bar{I})
\end{align*}
 By the strict convexity of $\gamma$ and strict concavity of $\pi$, in addition to our Inada conditions, the solution exists and is unique.

If $R$ were to increase, the steady state level of $\pi'(\bar{k})$ would increase, resulting in a reduction in $\bar{k}$, and since $\bar{I} = \delta \bar{k}$, $\bar{I}$ will fall as well.

\subsection{Part C}
Our optimality conditions become:
\begin{align*}
-(k'-k^{*}) &= R(k' - (1-\delta)k) + (1-\delta)(I')\\
\Rightarrow -(k'-k^{*}) &= RI -(1-\delta)I'\\
\end{align*}
\section{Question 4}
\subsection{Part A}
%The Bellman equation takes the following form:
%\begin{align*}
%V(k) =\max_{c} \frac{1}{1-\gamma} (c G^{\eta})^{1-\gamma} + \beta V((1-\delta)k +f(k) - c)
%\end{align*}
%
%We will find the conditions for maximization by taking first order conditions and applying the envelope conditions:
%
%\begin{align*}
%c^{-\gamma}(G^{\eta})^{1-\gamma} - \beta V'((1-\delta)k +f(k) - c) &= 0\\
%V'(k) &= \beta V'((1-\delta)k + f(k) - c) (1-\delta + f'(k))\\
%\Rightarrow c^{-\gamma}(G^{\eta})^{1-\gamma} &= \frac{V'(k)}{1-\delta + f'(k)} \\
%\Rightarrow V'(k) &=  c^{-\gamma}(G^{\eta})^{1-\gamma} (1-\delta + f'(k))\\
%\Rightarrow c^{-\gamma}(G^{\eta})^{1-\gamma} &= \beta c^{-\gamma}(G^{\eta})^{1-\gamma} (1-\delta + f'((1-\delta)k +f(k) - c))\\
%\Rightarrow \frac{1}{\beta} &= 1-\delta + f'((1-\delta)k +f(k) - c)\\
%\Rightarrow f'((1-\delta)k +f(k) - c) &= \frac{1}{\beta} + \delta - 1.
%\end{align*}
%\subsection{Part B}
%
%Yes, we can still have a unique steady state regardless of g. We can solve for $\bar{c},\bar{k}$ as follows:
%\begin{align*}
%\bar{c}&= (1-\delta)\bar{k}  + f(\bar{k}) - f'^{-1}( \frac{1}{\beta} + \delta - 1)\\
%\delta \bar{k} - f(\bar{k}) = - \bar{c}
%\end{align*}
%The above equations form 2 equations in 2 unknowns which pin down our steady state values.
%\subsection{Part C}
We will write our Bellman equation in the following form:
\begin{align}
V(k) = \max_{k'} (((1-\delta) k + f(k) - k')G^{\eta})^{1-\gamma}/(1-\gamma) + \beta V(k') \label{eqn:bellk}
\end{align}

By taking first order conditions and applying the envelope theorem, we get the following:
\begin{align*}
\beta V'(k') &=((1-\delta) k + f(k) - k')^{-\gamma}G^{\eta(1-\gamma)}\\
V'(k') &=((1-\delta) k' + f(k') - k'')^{-\gamma}(G')^{\eta(1-\gamma)}((1-\delta) + f'(k'))\\
\Rightarrow ((1-\delta) k + f(k) - k')^{-\gamma}G^{\eta(1-\gamma)} &=\beta ((1-\delta) k' + f(k') - k'')^{-\gamma}(G')^{\eta(1-\gamma)}((1-\delta) + f'(k'))\\
\end{align*}
\begin{align}
\Rightarrow \left( \frac{c'}{c}\right)^{\gamma} &= \left( \frac{G'}{G}\right)^{\eta(1-\gamma)}\beta ((1-\delta) + f'(k')) \label{eqn:optconk}
\end{align}

Equation (\ref{eqn:optconk}) along with the identity $k' = (1-\delta)k + f(k) - c$ form our difference equations for $k',c'$ (2 equations, 2 variables).

\subsection{Part B}

If government spending grows at a constant rate, $g$, then we can find steady state values $\bar{k},\bar{c}$ from our difference equations:

\begin{align*}
1 = g^{\eta(1-\gamma)}\beta((1-\delta) + f'(\bar{k}))\\
\Rightarrow \bar{k} = f'^{-1}(g^{-\eta(1-\gamma)}\beta^{-1} - 1+ \delta)\\
\Rightarrow \bar{c} = f(\bar{k}) - \delta \bar{k}.
\end{align*}

\subsection{Part C}
Our identity $k' = (1-\delta)k + f(k) - c$ shows that in the period where $g$ increases, the level of capital was already predetermined in the period before so it will remain at its initial level. Our value for $c$ then makes the initial adjustment, and as $g$ increases then $c'/c$ increases, so (assuming consumption is positive), consumption increases. The increase in consumption results in lower capital in the next period. This lower capital increases $f'(k)$, resulting in a further increase in consumption. Eventually, the system will approach its new steady state. The new steady state value for capital will be lower as an increase in $g$ will result in a decrease in $f'^{-1}$, and therefore a decrease in $\bar{k}.$ The lower value for the steady state of capital has an indeterminate effect on the steady state of consumption as it will increase the $f(\bar{k})$ term but decrease the $-\delta \bar{k}$ term.
\end{document}
